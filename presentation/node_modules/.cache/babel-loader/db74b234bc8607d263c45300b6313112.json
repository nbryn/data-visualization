{"ast":null,"code":"import { LOGIN } from \"./ActionTypes\";\nimport axios from \"axios\";\nconst url = \"https://anpjwd4bz4.execute-api.eu-central-1.amazonaws.com/dev/graphql\";\nexport const login = (username, password, history) => async dispatch => {\n  const data = \"mutation {\\n        signin(input: {\\n          channel: ANDROID\\n          username: \\\"\".concat(username, \"\\\"\\n          password: \\\"\").concat(password, \"\\\"\\n        }) {\\n          ... on ValidationError {\\n            result {\\n              field\\n              errors\\n            }\\n          }\\n    \\n          ... on Login {\\n            token\\n            refreshToken\\n            deviceId\\n            user {\\n              email\\n              phoneCode\\n              phoneNumber\\n              username\\n              firstName\\n              lastName\\n              image\\n              gender\\n              language\\n              active\\n              verified\\n            }  \\n          }\\n        }\\n      }\");\n  let result;\n\n  try {\n    result = await axios({\n      url,\n      method: \"post\",\n      data: {\n        query: data\n      }\n    }); // Flag for error in DB?\n\n    if (result.data.data.signin.result) {\n      return result.data.data.signin.result[0].errors;\n    } else {\n      console.log(result);\n      dispatch({\n        type: LOGIN,\n        payload: result.data.data.signin.user\n      });\n      const token = result.data.data.signin.token;\n      localStorage.setItem(\"jwtToken\", token);\n      history.push(\"/dashboard\");\n    } // Need better handling of network errors here\n\n  } catch (err) {\n    console.log(err);\n    return \"\";\n  }\n};","map":{"version":3,"sources":["/home/nbryn/Desktop/JamiiPay/jamiipay-web-dashboard/src/redux/actions/UserActions.js"],"names":["LOGIN","axios","url","login","username","password","history","dispatch","data","result","method","query","signin","errors","console","log","type","payload","user","token","localStorage","setItem","push","err"],"mappings":"AAAA,SAASA,KAAT,QAAsB,eAAtB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,MAAMC,GAAG,GACP,uEADF;AAGA,OAAO,MAAMC,KAAK,GAAG,CAACC,QAAD,EAAWC,QAAX,EAAqBC,OAArB,KAAiC,MAAMC,QAAN,IAAkB;AACtE,QAAMC,IAAI,oGAGWJ,QAHX,uCAIWC,QAJX,kkBAAV;AAkCA,MAAII,MAAJ;;AAEA,MAAI;AACFA,IAAAA,MAAM,GAAG,MAAMR,KAAK,CAAC;AACnBC,MAAAA,GADmB;AAEnBQ,MAAAA,MAAM,EAAE,MAFW;AAGnBF,MAAAA,IAAI,EAAE;AACJG,QAAAA,KAAK,EAAEH;AADH;AAHa,KAAD,CAApB,CADE,CASF;;AACA,QAAIC,MAAM,CAACD,IAAP,CAAYA,IAAZ,CAAiBI,MAAjB,CAAwBH,MAA5B,EAAoC;AAClC,aAAOA,MAAM,CAACD,IAAP,CAAYA,IAAZ,CAAiBI,MAAjB,CAAwBH,MAAxB,CAA+B,CAA/B,EAAkCI,MAAzC;AACD,KAFD,MAEO;AACLC,MAAAA,OAAO,CAACC,GAAR,CAAYN,MAAZ;AACAF,MAAAA,QAAQ,CAAC;AACPS,QAAAA,IAAI,EAAEhB,KADC;AAEPiB,QAAAA,OAAO,EAAER,MAAM,CAACD,IAAP,CAAYA,IAAZ,CAAiBI,MAAjB,CAAwBM;AAF1B,OAAD,CAAR;AAKA,YAAMC,KAAK,GAAGV,MAAM,CAACD,IAAP,CAAYA,IAAZ,CAAiBI,MAAjB,CAAwBO,KAAtC;AACAC,MAAAA,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiCF,KAAjC;AAEAb,MAAAA,OAAO,CAACgB,IAAR,CAAa,YAAb;AACD,KAvBC,CA2BF;;AACD,GA5BD,CA4BE,OAAOC,GAAP,EAAY;AACZT,IAAAA,OAAO,CAACC,GAAR,CAAYQ,GAAZ;AACA,WAAO,EAAP;AACD;AACF,CArEM","sourcesContent":["import { LOGIN } from \"./ActionTypes\";\nimport axios from \"axios\";\n\nconst url =\n  \"https://anpjwd4bz4.execute-api.eu-central-1.amazonaws.com/dev/graphql\";\n\nexport const login = (username, password, history) => async dispatch => {\n  const data = `mutation {\n        signin(input: {\n          channel: ANDROID\n          username: \"${username}\"\n          password: \"${password}\"\n        }) {\n          ... on ValidationError {\n            result {\n              field\n              errors\n            }\n          }\n    \n          ... on Login {\n            token\n            refreshToken\n            deviceId\n            user {\n              email\n              phoneCode\n              phoneNumber\n              username\n              firstName\n              lastName\n              image\n              gender\n              language\n              active\n              verified\n            }  \n          }\n        }\n      }`;\n\n  let result;\n\n  try {\n    result = await axios({\n      url,\n      method: \"post\",\n      data: {\n        query: data\n      }\n    });\n\n    // Flag for error in DB?\n    if (result.data.data.signin.result) {\n      return result.data.data.signin.result[0].errors;\n    } else {\n      console.log(result);\n      dispatch({\n        type: LOGIN,\n        payload: result.data.data.signin.user\n      });\n\n      const token = result.data.data.signin.token;\n      localStorage.setItem(\"jwtToken\", token);\n\n      history.push(\"/dashboard\");\n    }\n\n\n\n    // Need better handling of network errors here\n  } catch (err) {\n    console.log(err);\n    return \"\";\n  }\n};\n"]},"metadata":{},"sourceType":"module"}